

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/awesomeface.png">
  <link rel="icon" href="/img/awesomeface.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="周洪锋">
  <meta name="keywords" content="">
  
    <meta name="description" content="本科学《数据结构》时，就已经学过AVL树这一高效的查找数据结构，然而对于B树、B+树以及红黑树，却只是蜻蜓点水。本篇博客将从逻辑角度研究这三类平衡树的增删改查操作，并比较其效率和应用场景。  B树 B树（B-tree）（因为英文的这种写法，也尝尝被误认为是B-树），是一种自平衡的树。一个 mmm 阶的B树有如下性质：  最多有 mmm 个子树，即最多有 m−1m-1m−1 个键； 除了根节点外，其">
<meta property="og:type" content="article">
<meta property="og:title" content="B树、B+树、红黑树">
<meta property="og:url" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/index.html">
<meta property="og:site_name" content="周洪锋的博客">
<meta property="og:description" content="本科学《数据结构》时，就已经学过AVL树这一高效的查找数据结构，然而对于B树、B+树以及红黑树，却只是蜻蜓点水。本篇博客将从逻辑角度研究这三类平衡树的增删改查操作，并比较其效率和应用场景。  B树 B树（B-tree）（因为英文的这种写法，也尝尝被误认为是B-树），是一种自平衡的树。一个 mmm 阶的B树有如下性质：  最多有 mmm 个子树，即最多有 m−1m-1m−1 个键； 除了根节点外，其">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/btreebuild.gif">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404152406.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404152423.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404152516.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404153116.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404153436.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404153446.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404154415.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404155504.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404155633.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404155741.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404162331.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404162942.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404163606.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165027.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165135.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165242.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165254.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404170040.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404170633.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404171122.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404201922.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404172355.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404192210.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404172409.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404173825.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404203035.png">
<meta property="og:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404203055.png">
<meta property="article:published_time" content="2025-04-04T06:49:54.000Z">
<meta property="article:modified_time" content="2025-04-04T12:51:09.053Z">
<meta property="article:author" content="周洪锋">
<meta property="article:tag" content="树">
<meta property="article:tag" content="数据结构">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://zhouhf.top/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/btreebuild.gif">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>B树、B+树、红黑树 - 周洪锋的博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/KaTeX/0.15.2/katex.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"zhouhf.top","root":"/","version":"1.9.0","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>

  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>周洪锋的博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友链
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="B树、B+树、红黑树"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        周洪锋
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-04-04 14:49" pubdate>
          2025年4月4日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          4.1k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          34 分钟
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> 次
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">B树、B+树、红黑树</h1>
            
            <div class="markdown-body">
              
              <p>本科学《数据结构》时，就已经学过AVL树这一高效的查找数据结构，然而对于B树、B+树以及红黑树，却只是蜻蜓点水。本篇博客将从逻辑角度研究这三类平衡树的增删改查操作，并比较其效率和应用场景。</p>
<h1 id="b树"><a class="markdownIt-Anchor" href="#b树"></a> B树</h1>
<p><strong>B树（B-tree）</strong>（因为英文的这种写法，也尝尝被误认为是B-树），是一种自平衡的树。一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 阶的B树有如下性质：</p>
<ol>
<li>最多有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 个子树，即最多有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个键；</li>
<li>除了根节点外，其他节点最少有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \frac{m}{2}\rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span></span></span></span> 个子树；</li>
<li>拥有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 个子树的非叶子结点拥有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个元素，且升序排列；</li>
<li>所有的叶子结点在同一层。</li>
</ol>
<h2 id="查找与遍历"><a class="markdownIt-Anchor" href="#查找与遍历"></a> 查找与遍历</h2>
<p>根据B树键的有序性，不难直接思考得出查找与遍历的算法，略。</p>
<h2 id="插入"><a class="markdownIt-Anchor" href="#插入"></a> 插入</h2>
<p>插入新元素时，主要需要注意B树的第一条性质。首先可以说服自己，插入一定是发生在叶子节点。为了简便起见，我们先考虑几种比较dummy的情况：</p>
<ol>
<li>如果树为空，直接创建一个新的节点；</li>
<li>如果树不为空，找到一个适合插入的叶子结点位置，此时如果叶子结点还有空位置，则直接按照升序的原则将元素插入。<br>
接下来是重头戏：如果叶子结点已经有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 个键，那么就要分裂当前这个叶节点。<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/btreebuild.gif" srcset="/img/loading.gif" lazyload alt="插入新元素的过程"><br>
不妨假设叶节点可以容下 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 个键，于是我们可以将新元素存入叶节点中。然后我们取这个叶节点的中位数，将这个中位数提到父节点中，中位数左边的节点作为一个新节点，右边的节点作为一个新节点，则叶子结点分裂完成。如果此时父节点的键数也满，则对父节点进行递归操作。</li>
</ol>
<h2 id="删除"><a class="markdownIt-Anchor" href="#删除"></a> 删除</h2>
<p>删除可能发生在叶子结点上，也可以发生在非叶子结点上，并且删除时，主要注意满足B树的性质2。<br>
为简便起见，我们先不考虑性质2，当要删除的元素在叶子结点上时，直接删除即可；当要删除的元素在非叶子结点上时，删除该元素后，还需要从子节点中提取一个元素以填补空白，可以是被删除节点的前继（左子树的最大键）或后继（右子树的最小键）。<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404152406.png" srcset="/img/loading.gif" lazyload alt="原始状态"><br>
在上图的B树中删除键为21的节点：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404152423.png" srcset="/img/loading.gif" lazyload alt="删除节点21后"><br>
接着删除键为27的节点：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404152516.png" srcset="/img/loading.gif" lazyload alt="删除节点27"><br>
如果不考虑B树的性质2，那么到这里就结束了。但是我们为了维持B树的性质2，还需要进行额外的操作。<br>
当前节点的键数目低于下限后，就要考虑<strong>从兄弟节点借元素</strong>（左右兄弟都可以，这里统一取左兄弟）。根据兄弟节点的键够不够，还可以分为两种情况：</p>
<ul>
<li>兄弟节点的键大于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lceil \frac{m}{2}\rceil-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>，即借出去一个自己也不会太少：将父节点的元素下移，并将兄弟节点的最大键上移（这种情况很像AVL树的右旋）；</li>
<li>兄弟节点的键等于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">⌈</mo><mfrac><mi>m</mi><mn>2</mn></mfrac><mo stretchy="false">⌉</mo></mrow><annotation encoding="application/x-tex">\lceil \frac{m}{2}\rceil</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.095em;vertical-align:-0.345em;"></span><span class="mopen">⌈</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.695392em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">⌉</span></span></span></span>：就要考虑将两个兄弟节点合并，将父结点中两个兄弟之间的那个元素取下来，并合并左右兄弟。!<br>
对上图的B树进行调整后：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404153116.png" srcset="/img/loading.gif" lazyload alt="删除节点27的调整"><br>
删除节点32会引起第二种情况的调整：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404153436.png" srcset="/img/loading.gif" lazyload alt="删除32"><br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404153446.png" srcset="/img/loading.gif" lazyload alt="调整"><br>
当然了，这里父节点的键又低于下限了，所以需要递归调整。</li>
</ul>
<h1 id="b树-2"><a class="markdownIt-Anchor" href="#b树-2"></a> B+树</h1>
<p>B+树可以看成是B树的一个变种，两种树的大部分性质是类似了，只有一点不同，<strong>即B+树的非叶子结点不储存数据，只存键，所有数据都保存在叶子结点中</strong>。也由于B+树的这个特性，为了方便范围查询，叶子结点之间还会用指针串联起来：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404154415.png" srcset="/img/loading.gif" lazyload alt="B+树的典型结构"></p>
<h2 id="查找-遍历"><a class="markdownIt-Anchor" href="#查找-遍历"></a> 查找、遍历</h2>
<p>除了叶子节点存在后继指针外，与B树类似，略。</p>
<h2 id="插入-2"><a class="markdownIt-Anchor" href="#插入-2"></a> 插入</h2>
<p>插入需要分插入叶子类型（值）和插入非叶子（索引）两种情况，与B树也很类似。<br>
不同的是，在插入叶子类型时，只是将键上移到父节点中，<strong>小于等于中位数的作为左兄弟，大于中位数的作为右兄弟</strong>（回忆B树的分裂，小于中位数的作为左兄弟，等于中位数的作为父结点的新元素，大于中位数的作为右兄弟）。最后中位数的键（只有键，没有值）上移，对父节点进行递归操作。</p>
<h1 id="红黑树"><a class="markdownIt-Anchor" href="#红黑树"></a> 红黑树</h1>
<p>红黑树有以下几个性质：</p>
<ol>
<li>节点分为红色和黑色两种；</li>
<li>根是黑色；</li>
<li>叶子结点即 <code>null</code> 结点，必须为黑色；</li>
<li>红色结点的子节点和父结点都是黑色；</li>
<li>从根结点到叶子结点的所有路径都包含相同数目的黑色结点；<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404155504.png" srcset="/img/loading.gif" lazyload alt="典型的红黑树"><br>
<strong>为了方便起见，接下来所有的 <code>null</code> 节点都被省略。</strong></li>
</ol>
<h2 id="红黑树的等价"><a class="markdownIt-Anchor" href="#红黑树的等价"></a> 红黑树的等价</h2>
<p>理解红黑树特点的最重要的一点，就是将其与B树等价，对于下面这样结构的红黑树：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404155633.png" srcset="/img/loading.gif" lazyload alt="红黑树"><br>
可以将其与一棵<strong>4阶B树</strong>等价：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404155741.png" srcset="/img/loading.gif" lazyload alt="等价后的B树"><br>
不一样的是，普通的4阶B树是新元素是从从下标0开始插入的，而红黑树等价的4阶B树是先插入下标1，接下来有新元素时，再根据键的大小来决定是插入下标0还是下标2。</p>
<h2 id="插入-3"><a class="markdownIt-Anchor" href="#插入-3"></a> 插入</h2>
<p>在红黑树中进行插入需要分很多种情况进行讨论。最特殊的一种就是，原来的红黑树是空树，此时新插入的节点需要设定为黑色，以满足性质2。<br>
接下来是其他情况，其他情况下，新插入的节点必须被染成红色，以保证以最小的可能性破坏性质5。根据被插入节点的节点数目，可以分为12种情况（在上面这个B树中的叶子结点中恰好包含了所有情况），可以说是相当复杂。但是也不是没有规律可以寻找，我们依旧可以将红黑树与B树等价起来，然后探究各种情况的本质，分类讨论。</p>
<h3 id="直接符合红黑树性质的4种情况"><a class="markdownIt-Anchor" href="#直接符合红黑树性质的4种情况"></a> 直接符合红黑树性质的4种情况</h3>
<p><img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404162331.png" srcset="/img/loading.gif" lazyload alt="直接符合红黑树树性质的4种情况"><br>
上述这4种情况（父结点为黑色）在插入时不会破坏红黑树的性质，可以直接插入。<br>
这4种情况映射到B树的本质，就是直接在叶子结点的开头或结尾插入了一个元素，并且恰好插入到了下标0或2的位置。</p>
<h3 id="旋转并染色就可以解决的4种情况"><a class="markdownIt-Anchor" href="#旋转并染色就可以解决的4种情况"></a> 旋转并染色就可以解决的4种情况</h3>
<p>父节点为红色，且没有叔节点的情况是可以通过旋转+染色就可以解决的。根据父结点在爷结点的位置以及新插入节点在父结点的位置，共可以分为以下4种情况：</p>
<h4 id="ll与rr"><a class="markdownIt-Anchor" href="#ll与rr"></a> LL与RR</h4>
<p><img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404162942.png" srcset="/img/loading.gif" lazyload alt="单次旋转的2种情况"><br>
这2种情况映射到B树的本质，就是在叶子结点的开头或结尾插入了一个元素，但是插入到了下标-1或3的位置，需要整体平移（左旋或右旋+染色）。</p>
<h4 id="rl与lr"><a class="markdownIt-Anchor" href="#rl与lr"></a> RL与LR</h4>
<p><img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404163606.png" srcset="/img/loading.gif" lazyload alt="两次旋转的2种情况"><br>
这2种情况映射到B树的本质，就是在叶子结点的中间插入了一个元素，需要重新排序（左旋并右旋或右旋并左旋+染色）。</p>
<h3 id="需要上移的4种情况"><a class="markdownIt-Anchor" href="#需要上移的4种情况"></a> 需要上移的4种情况</h3>
<p>父结点为红色，且有叔节点，这种情况对应着B树种需要上移的情况（上图中的10、20、30、36）。具体地，根据父结点在爷结点的位置，又可以分四种情况，这里举两种典型例子来说明：</p>
<h4 id="ll与lr的情况"><a class="markdownIt-Anchor" href="#ll与lr的情况"></a> LL与LR的情况</h4>
<p>LL的情况：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165027.png" srcset="/img/loading.gif" lazyload alt="LL的情况"><br>
LL的情况调整后：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165135.png" srcset="/img/loading.gif" lazyload alt="LL情况调整后"></p>
<h4 id="rl与lr的情况"><a class="markdownIt-Anchor" href="#rl与lr的情况"></a> RL与LR的情况</h4>
<p>RL的情况<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165242.png" srcset="/img/loading.gif" lazyload alt="RL的情况"><br>
RL调整后<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404165254.png" srcset="/img/loading.gif" lazyload alt="RL调整后"><br>
总结一下这4种情况，本质上都是在B树中的一个满的叶子节点插入，然后将中位数上移。但是使用红黑树的一个很大好处就是，如上图所示，虽然在等价的B树中，需要上移和分裂等操作，但是我们实际上只要在红黑树中调整颜色即可，省去了很多操作。</p>
<h2 id="删除-2"><a class="markdownIt-Anchor" href="#删除-2"></a> 删除</h2>
<p>删除依旧分了很多种情况，回顾一下B树中元素的删除，我们分了元素是否在叶子结点上来讨论，对于红黑树，也可以采用类似的思路。当删除的元素在等价B树的非叶子结点上时，则直接删除，并使用前继或后继来填充，并递归操作。所以接下来只需要考虑元素在等价B树的叶子节点上的情况即可。<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404170040.png" srcset="/img/loading.gif" lazyload alt="元素在等价B树叶子结点上的情况"></p>
<h3 id="没有突破键数目下限的情况"><a class="markdownIt-Anchor" href="#没有突破键数目下限的情况"></a> 没有突破键数目下限的情况</h3>
<p>首先是dummy的情况，如果是红色，可以直接删除。<br>
其次，是如图是25、46、76这3种删除节点为黑色的情况，它们有一个子节点，所以也可以直接删除，并使用儿子节点来代替（并需要将后继结点染色）。<br>
下面是删除46、76后的红黑树。<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404170633.png" srcset="/img/loading.gif" lazyload alt="删除46和76的情况"><br>
对于删除25的情况，也只需要任选一个儿子节点来替代即可。<br>
对应到B树中，这几种情况都没有突破4阶B树的<strong>至少一个键</strong>的性质。</p>
<h3 id="突破键数目下限的情况"><a class="markdownIt-Anchor" href="#突破键数目下限的情况"></a> 突破键数目下限的情况</h3>
<p><img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404171122.png" srcset="/img/loading.gif" lazyload alt="突破键下限的情况"><br>
回顾B树中，如果结点的键数目突破下限，则需要从兄弟节点借一个元素。在上面这棵红黑树中，如果我们要删除88这个节点，则相当于把B树的叶节点数目删到0了，此时就要从兄弟节点借一个元素（其实是从父结点借元素，然后兄弟节点上移）。<br>
接下来又可以分两种情况：</p>
<h4 id="兄弟节点儿子数目够"><a class="markdownIt-Anchor" href="#兄弟节点儿子数目够"></a> 兄弟节点儿子数目够</h4>
<p>父节点下移，兄弟节点上移。对应到红黑树的操作就是旋转，此时需要根据自己和兄弟的位置情况判断是LL、RR、RL、LR四种情况中的哪一种（兄弟节点有两个子节点时，LL和RR都可以）。<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404201922.png" srcset="/img/loading.gif" lazyload alt></p>
<h4 id="兄弟节点儿子数目不够"><a class="markdownIt-Anchor" href="#兄弟节点儿子数目不够"></a> 兄弟节点儿子数目不够</h4>
<p>对应B树中的操作就是从父结点下移一个元素，并合并两个兄弟节点。 这里情况比较特殊，我们可以把被删除元素所在节点看成一个“键数为0”，但没有被删除的B树结点。此处根据B树父结点的值位置，还可以分出两种情况：<br>
<strong>情况1：键位于1和2</strong>：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404172355.png" srcset="/img/loading.gif" lazyload alt="键位于1和2"><br>
<strong>情况2：键位于0和1</strong>：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404192210.png" srcset="/img/loading.gif" lazyload alt><br>
两种情况调整后的结构均为：<br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404172409.png" srcset="/img/loading.gif" lazyload alt="删除后"><br>
但是，由于55和80这两个节点的关系不一样，所以具体的代码也是不一样的，但是对应B树的逻辑上的操作是一样的。<br>
<strong>情况3：特殊情况，需要注意，由于这种情况导致了父结点的下移，所以需要使用递归，把父结点80也当做被删除节点：</strong><br>
<img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404173825.png" srcset="/img/loading.gif" lazyload alt="特殊情况"></p>
<h2 id="删除规约版本"><a class="markdownIt-Anchor" href="#删除规约版本"></a> 删除（规约版本）</h2>
<p>经过上一节讨论可以发现，红黑只有当被删除节点无子节点时，才需要调整。而这个调整的过程又十分繁琐，需要考虑的情况非常多，而根据<a target="_blank" rel="noopener" href="https://leetcode.cn/discuss/post/3101686/hong-hei-shu-shu-adtlian-zai-613-by-yuki-tjoy/">红黑树从入门到看开</a>这篇优质文章以及《算法导论》的规约，可以得到以下四个情形：</p>
<p><img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404203035.png" srcset="/img/loading.gif" lazyload alt="文字形式"></p>
<p><img src="/2025/04/04/%E7%AE%97%E6%B3%95/B-tree-B-tree-and-RBTree/Pasted%20image%2020250404203055.png" srcset="/img/loading.gif" lazyload alt="图片形式"></p>
<h1 id="对比"><a class="markdownIt-Anchor" href="#对比"></a> 对比</h1>
<p>回顾一下整篇文章，对AVL树、B树、B+树以及红黑树做一个总结。</p>
<h2 id="b树-b树"><a class="markdownIt-Anchor" href="#b树-b树"></a> B树、B+树</h2>
<p>首先B树与B+树的对比，B+树将所有数据都存储在叶子结点，这个特点使内存中的索引与磁盘中的数据分离，适合作为数据库的索引。并且叶子结点之间的链表链接极大地方便了范围查询。<br>
而B树通过多路平衡设计，减少了平衡树的高度，加快搜索效率，适合文件系统，以及需要直接访问内部节点的场景。<br>
它们的查询、插入和删除效率均为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(\log n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<h2 id="avl树和红黑树"><a class="markdownIt-Anchor" href="#avl树和红黑树"></a> AVL树和红黑树</h2>
<p>AVL树和红黑树最大的特点就是AVL树是严格平衡的，这导致插入和删除操作较慢，而红黑树对高度要求不是特别严格，可以以更少的旋转次数完成调整。也正是因为这个，在查找速度上来说，AVL树的查找速度更快。<br>
总的来说，对于数据需要频繁插入和删除的场景，使用红黑树，而数据修改较少的场景，使用AVL树。</p>
<h2 id="4阶b树与红黑树"><a class="markdownIt-Anchor" href="#4阶b树与红黑树"></a> 4阶B树与红黑树</h2>
<p>既4阶B树与红黑树是同构的，那么为什么各大语言的内置库都是使用红黑树而不是B树呢？询问Deepseek，我认为<strong>内存效率</strong>是最主要的因素：</p>
<blockquote>
<p>红黑树的节点体积更小（仅需存储颜色位+两个指针），在内存中分布更紧凑，​<strong>​缓存局部性（Cache Locality）​</strong>​更好。而2-3-4树的节点需要存储多个键和子节点指针，单个节点体积更大，遍历时可能触发更多缓存未命中，影响性能。​</p>
</blockquote>
<h1 id="参考链接"><a class="markdownIt-Anchor" href="#参考链接"></a> 参考链接：</h1>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/cy973071263/article/details/122543826">【数据结构】史上最好理解的红黑树讲解，让你彻底搞懂红黑树</a><br>
<a target="_blank" rel="noopener" href="https://oi-wiki.org/ds/b-tree/">OI Wiki</a><br>
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wxiaotong/p/14781753.html">一文搞懂B树、B-树、B+树</a><br>
<a target="_blank" rel="noopener" href="https://leetcode.cn/discuss/post/3101686/hong-hei-shu-shu-adtlian-zai-613-by-yuki-tjoy/">红黑树从入门到看开</a></p>
<link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
              
            </div>
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/%E7%AE%97%E6%B3%95/" class="category-chain-item">算法</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E6%A0%91/">#树</a>
      
        <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">#数据结构</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>B树、B+树、红黑树</div>
      <div>http://zhouhf.top/2025/04/04/算法/B-tree-B-tree-and-RBTree/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>周洪锋</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年4月4日</div>
        </div>
      
      
      <div class="license-meta-item">
        <div>许可协议</div>
        <div>
          
            
            
              <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
              <span class="hint--top hint--rounded" aria-label="BY - 署名">
                <i class="iconfont icon-by"></i>
              </span>
              </a>
            
          
        </div>
      </div>
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/20/%E7%BD%91%E7%BB%9C/minnow-cpp/" title="minnow_cpp">
                        <span class="hidden-mobile">minnow_cpp</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  <article id="comments" lazyload>
    
  <div id="gitalk-container"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#gitalk-container', function() {
      Fluid.utils.createCssLink('/css/gitalk.css')
      Fluid.utils.createScript('https://lib.baomitu.com/gitalk/1.7.2/gitalk.min.js', function() {
        var options = Object.assign(
          {"clientID":"Ov23liudPNomhUyrQIaq","clientSecret":"a9de1582a206aabfd5adb8a409d1689a5d447856","repo":"zhf999.github.io","owner":"zhf999","admin":["zhf999"],"language":"zh-CN","labels":["Gitalk"],"perPage":10,"pagerDirection":"last","distractionFreeMode":false,"createIssueManually":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token"},
          {
            id: '339fba91ce35f17b95578cb53f793c60'
          }
        )
        var gitalk = new Gitalk(options);
        gitalk.render('gitalk-container');
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


  </article>


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>






  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.0/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      headingSelector : CONFIG.toc.headingSelector || 'h1,h2,h3,h4,h5,h6',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      collapseDepth   : CONFIG.toc.collapseDepth || 0,
      scrollSmooth    : true,
      headingsOffset  : -boardTop
    });
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }
  });
</script>


  <script>
  (function() {
    var enableLang = CONFIG.code_language.enable && CONFIG.code_language.default;
    var enableCopy = CONFIG.copy_btn;
    if (!enableLang && !enableCopy) {
      return;
    }

    function getBgClass(ele) {
      return Fluid.utils.getBackgroundLightness(ele) >= 0 ? 'code-widget-light' : 'code-widget-dark';
    }

    var copyTmpl = '';
    copyTmpl += '<div class="code-widget">';
    copyTmpl += 'LANG';
    copyTmpl += '</div>';
    jQuery('.markdown-body pre').each(function() {
      var $pre = jQuery(this);
      if ($pre.find('code.mermaid').length > 0) {
        return;
      }
      if ($pre.find('span.line').length > 0) {
        return;
      }

      var lang = '';

      if (enableLang) {
        lang = CONFIG.code_language.default;
        if ($pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2 && $pre.children().hasClass('hljs')) {
          lang = $pre[0].children[0].classList[1];
        } else if ($pre[0].getAttribute('data-language')) {
          lang = $pre[0].getAttribute('data-language');
        } else if ($pre.parent().hasClass('sourceCode') && $pre[0].children.length > 0 && $pre[0].children[0].classList.length >= 2) {
          lang = $pre[0].children[0].classList[1];
          $pre.parent().addClass('code-wrapper');
        } else if ($pre.parent().hasClass('markdown-body') && $pre[0].classList.length === 0) {
          $pre.wrap('<div class="code-wrapper"></div>');
        }
        lang = lang.toUpperCase().replace('NONE', CONFIG.code_language.default);
      }
      $pre.append(copyTmpl.replace('LANG', lang).replace('code-widget">',
        getBgClass($pre[0]) + (enableCopy ? ' code-widget copy-btn" data-clipboard-snippet><i class="iconfont icon-copy"></i>' : ' code-widget">')));

      if (enableCopy) {
        Fluid.utils.createScript('https://lib.baomitu.com/clipboard.js/2.0.10/clipboard.min.js', function() {
          var clipboard = new window.ClipboardJS('.copy-btn', {
            target: function(trigger) {
              var nodes = trigger.parentNode.childNodes;
              for (var i = 0; i < nodes.length; i++) {
                if (nodes[i].tagName === 'CODE') {
                  return nodes[i];
                }
              }
            }
          });
          clipboard.on('success', function(e) {
            e.clearSelection();
            e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-copy', 'icon-success');
            setTimeout(function() {
              e.trigger.innerHTML = e.trigger.innerHTML.replace('icon-success', 'icon-copy');
            }, 2000);
          });
        });
      }
    });
  })();
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
